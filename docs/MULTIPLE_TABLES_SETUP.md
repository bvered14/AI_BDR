# Airtable Multiple Tables Setup Guide

This guide explains how to set up the multiple tables structure in Airtable for the BDR AI pipeline.

## üìã Required Tables

The BDR AI pipeline uses three main tables in Airtable:

### 1. **Companies Table**
Stores company information and metadata.

**Fields:**
- `Company Name` (Single line text) - Primary identifier
- `Website` (URL) - Company website
- `Industry` (Single select) - Industry classification
- `Number of Employees` (Number) - Company size
- `Tech Stack` (Long text) - Technology stack information
- `Notes` (Long text) - Additional notes
- `Fit Score` (Number) - Optional scoring (0-100)

### 2. **Contacts Table**
Stores individual contact information.

**Fields:**
- `Full Name` (Single line text) - Contact's full name
- `Email` (Email) - Contact's email address
- `Title / Role` (Single line text) - Job title
- `LinkedIn Profile` (URL) - LinkedIn profile URL
- `Company` (Link to Companies) - Link to company record
- `Outreach Message` (Long text) - Generated outreach message
- `Status` (Single select) - Contact status (New, Contacted, Responded, etc.)

### 3. **Emails Table**
Stores email campaign information and tracking.

**Fields:**
- `Contact` (Link to Contacts) - Link to contact record
- `To` (Email) - Recipient email address
- `Subject` (Single line text) - Email subject line
- `Body` (Long text) - Email body content
- `Send Now` (Checkbox) - Flag to send email
- `Sent At` (Date & Time) - When email was sent
- `Send Result` (Single select) - Success/Failed
- `Error` (Long text) - Error message if failed

## üõ†Ô∏è Setup Instructions

### Step 1: Create Tables

1. **Log into Airtable** and open your base
2. **Create three new tables** with the names above
3. **Add the fields** as specified in each table section

### Step 2: Configure Field Types

#### Companies Table
```
Company Name: Single line text
Website: URL
Industry: Single select (add options like: Technology, Healthcare, Finance, etc.)
Number of Employees: Number
Tech Stack: Long text
Notes: Long text
Fit Score: Number (optional)
```

#### Contacts Table
```
Full Name: Single line text
Email: Email
Title / Role: Single line text
LinkedIn Profile: URL
Company: Link to Companies (create the link)
Outreach Message: Long text
Status: Single select (add options: New, Contacted, Responded, Qualified, etc.)
```

#### Emails Table
```
Contact: Link to Contacts (create the link)
To: Email
Subject: Single line text
Body: Long text
Send Now: Checkbox
Sent At: Date & Time
Send Result: Single select (add options: Pending, Sent, Failed)
Error: Long text
```

### Step 3: Configure Links

1. **In Contacts table**: Create a "Link to Companies" field
2. **In Emails table**: Create a "Link to Contacts" field
3. **Set up the relationships** between tables

### Step 4: Add Sample Data (Optional)

Add a few sample records to test the structure:

#### Sample Company
```
Company Name: TechCorp Inc
Website: https://techcorp.com
Industry: Technology
Number of Employees: 150
Tech Stack: Python, AWS, React, PostgreSQL
Notes: Growing startup in fintech space
Fit Score: 85
```

#### Sample Contact
```
Full Name: John Doe
Email: john.doe@techcorp.com
Title / Role: CTO
LinkedIn Profile: https://linkedin.com/in/johndoe
Company: [Link to TechCorp Inc]
Outreach Message: [Will be generated by AI]
Status: New
```

## üîß Configuration

### Environment Variables

Update your `.env` file with the table names:

```env
AIRTABLE_TABLES=["Companies", "Contacts", "Emails"]
```

### API Permissions

Ensure your Airtable Personal Access Token has:
- **Read** access to all tables
- **Write** access to all tables
- **Create** access to all tables

## üß™ Testing the Setup

### Test Table Access

```python
from bdr_ai.airtable_api import AirtableAPI

# Test each table
companies = AirtableAPI("Companies")
contacts = AirtableAPI("Contacts")
emails = AirtableAPI("Emails")

# Test reading records
print("Companies:", len(companies.get_all_records()))
print("Contacts:", len(contacts.get_all_records()))
print("Emails:", len(emails.get_all_records()))
```

### Test Record Creation

```python
# Test creating a company
company_data = {
    "Company Name": "Test Company",
    "Website": "https://testcompany.com",
    "Industry": "Technology",
    "Number of Employees": 50
}

result = companies.create_record(company_data)
print("Created company:", result)
```

## üö® Common Issues

### 1. **Field Name Mismatches**
- Ensure field names exactly match the specifications
- Check for extra spaces or special characters

### 2. **Link Field Issues**
- Verify link fields are properly configured
- Test the relationships between tables

### 3. **Permission Errors**
- Check Personal Access Token permissions
- Ensure token has access to all tables

### 4. **API Rate Limits**
- Airtable has rate limits (5 requests per second)
- Implement retry logic for failed requests

## üìä Best Practices

1. **Consistent Naming**: Use exact field names as specified
2. **Data Validation**: Add validation rules in Airtable
3. **Backup Strategy**: Regularly export your data
4. **Monitoring**: Set up alerts for API errors
5. **Documentation**: Keep field descriptions updated

## üîÑ Maintenance

### Regular Tasks
- **Clean up old records** periodically
- **Update field options** as needed
- **Monitor API usage** and rate limits
- **Backup data** regularly

### Updates
- **Field additions**: Add new fields as needed
- **Relationship changes**: Update links if structure changes
- **Data migration**: Plan for schema changes

---

**Next Steps**: Once tables are set up, proceed to [Local Testing Guide](LOCAL_TESTING.md) to test the full pipeline.
